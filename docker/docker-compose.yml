version: "3"

services:
  

  # this is a helper service used because there's no official hardhat image
  postgres:
    image: omgx/blockexplorer-postgres:production-v1
    command: -p 5433
    environment:
      POSTGRES_PASSWORD: ""
      POSTGRES_USER: 'postgres'
      POSTGRES_HOST_AUTH_METHOD: 'trust'
    ports:
        # expose the service to the host for integration testing
      - 5433:5433

  # base service builder
  blockscout:
    image: omgx/blockexplorer-blockscout:production-v1
    restart: always
    command:
      /bin/sh -c "mix do ecto.create, ecto.migrate; mix phx.server"
    environment: 
      COIN: 'ETH'
      NETWORK: 'BOBA'
      SUBNETWORK: 'BOBA'
      DATABASE_URL: 'postgresql://postgres:@postgres:5433/explorer?ssl=false'
      MIX_ENV: 'prod'
      ETHEREUM_JSONRPC_VARIANT: 'geth'
      LOGO: '/images/boba_logo.svg'
      SUPPORTED_CHAINS: '[]'
      ETHEREUM_JSONRPC_HTTP_URL: 'https://mainnet.boba.network'
    ports:
      - 4000:4000
    # extra_hosts:
    #   - "host.docker.internal:host-gateway"